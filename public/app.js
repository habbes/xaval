!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t){const i="\n// Xaval is a playground for experimenting with computer vision using OpenCV\n\n// To get started, import an image from the bottom-left\n// Use `imsource.read()` to load the imported image into an OpenCV array\nconst img = imsource.read();\n// Do some image processing and manipulation using OpenCV\ncv.cvtColor(img, img, cv.COLOR_RGBA2GRAY, 0);\n// Then, to display an image, use `imviewer.show()`\nimviewer.show(img);\n\n// don't forget to clean up the memory\nimg.delete();\n\n// When you're ready, click the \"Run\" button\n\n// To learn more about OpenCV for JS,\n// check out the tutorials at\n// https://docs.opencv.org/3.4.1/d5/d10/tutorial_js_root.html\n";window.init=function(){const e=new n(document.querySelector("#editorContainer")),t=new o(document.querySelector("#imageViewer")),i=new s(document.querySelector("#imageSource"));return new r({editor:e,imageSource:i,imageViewer:t})};class r{constructor(e){this.editor=e.editor,this.imageSource=e.imageSource,this.imageViewer=e.imageViewer}start(){this.editor.setRunHandler(e=>{const t=this.runCode(e);console.log("Code result",t)}),this.editor.editor.focus()}runCode(e){return Function("imsource","imviewer",`"use strict";${e}`)(this.imageSource,this.imageViewer)}}class n{constructor(e){this.container=e,this.editorEl=e.querySelector("#editor"),this.editor=ace.edit(this.editorEl),this.editor.setValue(i),this.editor.setTheme("ace/theme/monokai"),this.editor.session.setMode("ace/mode/javascript"),this.editor.setShowPrintMargin(!1),this.editor.clearSelection(),this.runBtn=e.querySelector("button"),this.run=this.run.bind(this),this.runBtn.addEventListener("click",this.run)}setRunHandler(e){this.runHandler=e}get source(){return this.editor.getValue()}run(){this.runHandler&&this.runHandler(this.source)}}class o{constructor(e){this.el=e,this.canvas=e.querySelector(".canvas"),this.canvas.id=`canvas${o.nextId()}`}static nextId(){return o._nextId=(o._nextId||0)+1,o._nextId}show(e){cv.imshow(this.canvas.id,e)}}class s{constructor(e){this.el=e,this.thumbnail=e.querySelector("img"),this.image=new Image,this.inputEl=e.querySelector("input"),this.inputEl.addEventListener("change",e=>{this.thumbnail.src=URL.createObjectURL(e.target.files[0]),this.image.src=this.thumbnail.src},!1)}read(){return cv.imread(this.image)}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJJTklUSUFMX0NPREUiLCJ3aW5kb3ciLCJpbml0IiwiZWRpdG9yIiwiRWRpdG9yIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaW1hZ2VWaWV3ZXIiLCJJbWFnZVZpZXdlciIsImltYWdlU291cmNlIiwiSW1hZ2VTb3VyY2UiLCJBcHAiLCJbb2JqZWN0IE9iamVjdF0iLCJhcmdzIiwidGhpcyIsInNldFJ1bkhhbmRsZXIiLCJzb3VyY2UiLCJyZXMiLCJydW5Db2RlIiwiY29uc29sZSIsImxvZyIsImZvY3VzIiwiRnVuY3Rpb24iLCJleGVjdXRlIiwiZWwiLCJjb250YWluZXIiLCJlZGl0b3JFbCIsImFjZSIsImVkaXQiLCJzZXRWYWx1ZSIsInNldFRoZW1lIiwic2Vzc2lvbiIsInNldE1vZGUiLCJzZXRTaG93UHJpbnRNYXJnaW4iLCJjbGVhclNlbGVjdGlvbiIsInJ1bkJ0biIsInJ1biIsImJpbmQiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlciIsInJ1bkhhbmRsZXIiLCJnZXRWYWx1ZSIsImNhbnZhcyIsImlkIiwibmV4dElkIiwiX25leHRJZCIsIm1hdCIsImN2IiwiaW1zaG93IiwidGh1bWJuYWlsIiwiaW1hZ2UiLCJJbWFnZSIsImlucHV0RWwiLCJlIiwic3JjIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwidGFyZ2V0IiwiZmlsZXMiLCJpbXJlYWQiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUNBSyxjQUFBLEVBQ0FDLFlBQUEsRUFDQUMsSUFBQU4sS0FNQVosRUFBQW1CLEVBQUEsU0FBQWpCLEdBQ0FZLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURrQixPQUFBLEtBSWpEcEIsRUFBQXFCLEVBQUEsU0FBQWxCLEdBQ0EsSUFBQVMsRUFBQVQsS0FBQW1CLFdBQ0EsV0FBMkIsT0FBQW5CLEVBQUEsU0FDM0IsV0FBaUMsT0FBQUEsR0FFakMsT0FEQUgsRUFBQVUsRUFBQUUsRUFBQSxJQUFBQSxHQUNBQSxHQUlBWixFQUFBYSxFQUFBLFNBQUFVLEVBQUFDLEdBQXNELE9BQUFWLE9BQUFXLFVBQUFDLGVBQUFuQixLQUFBZ0IsRUFBQUMsSUFHdER4QixFQUFBMkIsRUFBQSxHQUlBM0IsSUFBQTRCLEVBQUEsbUJDOURBLE1BQUFDLEVBQUEsNHBCQW9DQUMsT0FBQUMsS0FkQSxXQUNBLE1BQUFDLEVBQUEsSUFBQUMsRUFBQUMsU0FBQUMsY0FBQSxxQkFDQUMsRUFBQSxJQUFBQyxFQUFBSCxTQUFBQyxjQUFBLGlCQUNBRyxFQUFBLElBQUFDLEVBQUFMLFNBQUFDLGNBQUEsaUJBUUEsT0FOQSxJQUFBSyxHQUNBUixTQUNBTSxjQUNBRix1QkFRQUksRUFPQUMsWUFBQUMsR0FDQUMsS0FBQVgsT0FBQVUsRUFBQVYsT0FDQVcsS0FBQUwsWUFBQUksRUFBQUosWUFDQUssS0FBQVAsWUFBQU0sRUFBQU4sWUFHQUssUUFDQUUsS0FBQVgsT0FBQVksY0FBQUMsSUFDQSxNQUFBQyxFQUFBSCxLQUFBSSxRQUFBRixHQUNBRyxRQUFBQyxJQUFBLGNBQUFILEtBR0FILEtBQUFYLGNBQUFrQixRQU9BVCxRQUFBSSxHQU9BLE9BTkFNLFNBQ0EsV0FDQSwyQkFDNEJOLElBRzVCTyxDQUNBVCxLQUFBTCxZQUNBSyxLQUFBUCxvQkFLQUgsRUFLQVEsWUFBQVksR0FDQVYsS0FBQVcsVUFBQUQsRUFFQVYsS0FBQVksU0FBQUYsRUFBQWxCLGNBQUEsV0FDQVEsS0FBQVgsT0FBQXdCLElBQUFDLEtBQUFkLEtBQUFZLFVBQ0FaLEtBQUFYLE9BQUEwQixTQUFBN0IsR0FDQWMsS0FBQVgsT0FBQTJCLFNBQUEscUJBQ0FoQixLQUFBWCxPQUFBNEIsUUFBQUMsUUFBQSx1QkFDQWxCLEtBQUFYLE9BQUE4QixvQkFBQSxHQUNBbkIsS0FBQVgsT0FBQStCLGlCQUNBcEIsS0FBQXFCLE9BQUFYLEVBQUFsQixjQUFBLFVBQ0FRLEtBQUFzQixJQUFBdEIsS0FBQXNCLElBQUFDLEtBQUF2QixNQUNBQSxLQUFBcUIsT0FBQUcsaUJBQUEsUUFBQXhCLEtBQUFzQixLQU9BeEIsY0FBQTJCLEdBQ0F6QixLQUFBMEIsV0FBQUQsRUFNQXZCLGFBRUEsT0FBQUYsS0FBQVgsT0FBQXNDLFdBR0E3QixNQUNBRSxLQUFBMEIsWUFBQTFCLEtBQUEwQixXQUFBMUIsS0FBQUUsZUFJQVIsRUFLQUksWUFBQVksR0FDQVYsS0FBQVUsS0FDQVYsS0FBQTRCLE9BQUFsQixFQUFBbEIsY0FBQSxXQUNBUSxLQUFBNEIsT0FBQUMsWUFBa0NuQyxFQUFBb0MsV0FHbENoQyxnQkFFQSxPQURBSixFQUFBcUMsU0FBQXJDLEVBQUFxQyxTQUFBLEtBQ0FyQyxFQUFBcUMsUUFPQWpDLEtBQUFrQyxHQUNBQyxHQUFBQyxPQUFBbEMsS0FBQTRCLE9BQUFDLEdBQUFHLFVBSUFwQyxFQUtBRSxZQUFBWSxHQUNBVixLQUFBVSxLQUNBVixLQUFBbUMsVUFBQXpCLEVBQUFsQixjQUFBLE9BQ0FRLEtBQUFvQyxNQUFBLElBQUFDLE1BQ0FyQyxLQUFBc0MsUUFBQTVCLEVBQUFsQixjQUFBLFNBRUFRLEtBQUFzQyxRQUFBZCxpQkFBQSxTQUFBZSxJQUNBdkMsS0FBQW1DLFVBQUFLLElBQUFDLElBQUFDLGdCQUFBSCxFQUFBSSxPQUFBQyxNQUFBLElBQ0E1QyxLQUFBb0MsTUFBQUksSUFBQXhDLEtBQUFtQyxVQUFBSyxNQUNTLEdBUVQxQyxPQUNBLE9BQUFtQyxHQUFBWSxPQUFBN0MsS0FBQW9DIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCIvKipcbiAqIEBhdXRob3IgSGFiYmVzIDxoZWxsb0BoYWJiZXMueHl6PlxuICovXG5cblxuY29uc3QgSU5JVElBTF9DT0RFID0gYFxuLy8gWGF2YWwgaXMgYSBwbGF5Z3JvdW5kIGZvciBleHBlcmltZW50aW5nIHdpdGggY29tcHV0ZXIgdmlzaW9uIHVzaW5nIE9wZW5DVlxuXG4vLyBUbyBnZXQgc3RhcnRlZCwgaW1wb3J0IGFuIGltYWdlIGZyb20gdGhlIGJvdHRvbS1sZWZ0XG4vLyBVc2UgXFxgaW1zb3VyY2UucmVhZCgpXFxgIHRvIGxvYWQgdGhlIGltcG9ydGVkIGltYWdlIGludG8gYW4gT3BlbkNWIGFycmF5XG5jb25zdCBpbWcgPSBpbXNvdXJjZS5yZWFkKCk7XG4vLyBEbyBzb21lIGltYWdlIHByb2Nlc3NpbmcgYW5kIG1hbmlwdWxhdGlvbiB1c2luZyBPcGVuQ1ZcbmN2LmN2dENvbG9yKGltZywgaW1nLCBjdi5DT0xPUl9SR0JBMkdSQVksIDApO1xuLy8gVGhlbiwgdG8gZGlzcGxheSBhbiBpbWFnZSwgdXNlIFxcYGltdmlld2VyLnNob3coKVxcYFxuaW12aWV3ZXIuc2hvdyhpbWcpO1xuXG4vLyBkb24ndCBmb3JnZXQgdG8gY2xlYW4gdXAgdGhlIG1lbW9yeVxuaW1nLmRlbGV0ZSgpO1xuXG4vLyBXaGVuIHlvdSdyZSByZWFkeSwgY2xpY2sgdGhlIFwiUnVuXCIgYnV0dG9uXG5cbi8vIFRvIGxlYXJuIG1vcmUgYWJvdXQgT3BlbkNWIGZvciBKUyxcbi8vIGNoZWNrIG91dCB0aGUgdHV0b3JpYWxzIGF0XG4vLyBodHRwczovL2RvY3Mub3BlbmN2Lm9yZy8zLjQuMS9kNS9kMTAvdHV0b3JpYWxfanNfcm9vdC5odG1sXG5gO1xuXG5cbmZ1bmN0aW9uIGluaXQgKCkge1xuICAgIGNvbnN0IGVkaXRvciA9IG5ldyBFZGl0b3IoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2VkaXRvckNvbnRhaW5lcicpKTtcbiAgICBjb25zdCBpbWFnZVZpZXdlciA9IG5ldyBJbWFnZVZpZXdlcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjaW1hZ2VWaWV3ZXInKSk7XG4gICAgY29uc3QgaW1hZ2VTb3VyY2UgPSBuZXcgSW1hZ2VTb3VyY2UoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2ltYWdlU291cmNlJykpXG5cbiAgICBjb25zdCBhcHAgPSBuZXcgQXBwKHtcbiAgICAgICAgZWRpdG9yLFxuICAgICAgICBpbWFnZVNvdXJjZSxcbiAgICAgICAgaW1hZ2VWaWV3ZXJcbiAgICB9KTtcblxuICAgIHJldHVybiBhcHA7XG59XG5cbndpbmRvdy5pbml0ID0gaW5pdDtcblxuY2xhc3MgQXBwIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge29iamVjdH0gYXJnc1xuICAgICAqIEBwYXJhbSB7RWRpdG9yfSBhcmdzLmVkaXRvclxuICAgICAqIEBwYXJhbSB7SW1hZ2VTb3VyY2V9IGFyZ3MuaW1hZ2VTb3VyY2VcbiAgICAgKiBAcGFyYW0ge0ltYWdlVmlld2VyfSBhcmdzLmltYWdlVmlld2VyXG4gICAgICovIFxuICAgIGNvbnN0cnVjdG9yIChhcmdzKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yID0gYXJncy5lZGl0b3I7XG4gICAgICAgIHRoaXMuaW1hZ2VTb3VyY2UgPSBhcmdzLmltYWdlU291cmNlO1xuICAgICAgICB0aGlzLmltYWdlVmlld2VyID0gYXJncy5pbWFnZVZpZXdlcjtcbiAgICB9XG5cbiAgICBzdGFydCAoKSB7XG4gICAgICAgIHRoaXMuZWRpdG9yLnNldFJ1bkhhbmRsZXIoc291cmNlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IHRoaXMucnVuQ29kZShzb3VyY2UpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvZGUgcmVzdWx0JywgcmVzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5lZGl0b3IuZWRpdG9yLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNvdXJjZSBcbiAgICAgKi9cbiAgICBydW5Db2RlIChzb3VyY2UpIHtcbiAgICAgICAgY29uc3QgZXhlY3V0ZSA9IEZ1bmN0aW9uKFxuICAgICAgICAgICAgJ2ltc291cmNlJyxcbiAgICAgICAgICAgICdpbXZpZXdlcicsXG4gICAgICAgICAgICBgXCJ1c2Ugc3RyaWN0XCI7JHtzb3VyY2V9YFxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBleGVjdXRlKFxuICAgICAgICAgICAgdGhpcy5pbWFnZVNvdXJjZSxcbiAgICAgICAgICAgIHRoaXMuaW1hZ2VWaWV3ZXJcbiAgICAgICAgKTtcbiAgICB9XG59XG4gXG5jbGFzcyBFZGl0b3Ige1xuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yIChlbCkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGVsO1xuXG4gICAgICAgIHRoaXMuZWRpdG9yRWwgPSBlbC5xdWVyeVNlbGVjdG9yKCcjZWRpdG9yJyk7XG4gICAgICAgIHRoaXMuZWRpdG9yID0gYWNlLmVkaXQodGhpcy5lZGl0b3JFbCk7XG4gICAgICAgIHRoaXMuZWRpdG9yLnNldFZhbHVlKElOSVRJQUxfQ09ERSk7XG4gICAgICAgIHRoaXMuZWRpdG9yLnNldFRoZW1lKFwiYWNlL3RoZW1lL21vbm9rYWlcIik7XG4gICAgICAgIHRoaXMuZWRpdG9yLnNlc3Npb24uc2V0TW9kZShcImFjZS9tb2RlL2phdmFzY3JpcHRcIik7XG4gICAgICAgIHRoaXMuZWRpdG9yLnNldFNob3dQcmludE1hcmdpbihmYWxzZSk7XG4gICAgICAgIHRoaXMuZWRpdG9yLmNsZWFyU2VsZWN0aW9uKCk7XG4gICAgICAgIHRoaXMucnVuQnRuID0gZWwucXVlcnlTZWxlY3RvcignYnV0dG9uJyk7XG4gICAgICAgIHRoaXMucnVuID0gdGhpcy5ydW4uYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5ydW5CdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLnJ1bik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciBcbiAgICAgKi9cbiAgICBzZXRSdW5IYW5kbGVyIChoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMucnVuSGFuZGxlciA9IGhhbmRsZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHJldHVybiB7c3RyaW5nfVxuICAgICAqL1xuICAgIGdldCBzb3VyY2UgKCkge1xuICAgICAgICAvLyByZXR1cm4gdGhpcy5lZGl0b3IudmFsdWU7XG4gICAgICAgIHJldHVybiB0aGlzLmVkaXRvci5nZXRWYWx1ZSgpO1xuICAgIH1cblxuICAgIHJ1biAoKSB7XG4gICAgICAgIHRoaXMucnVuSGFuZGxlciAmJiB0aGlzLnJ1bkhhbmRsZXIodGhpcy5zb3VyY2UpO1xuICAgIH1cbn1cblxuY2xhc3MgSW1hZ2VWaWV3ZXIge1xuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR9IGVsIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yIChlbCkge1xuICAgICAgICB0aGlzLmVsID0gZWw7XG4gICAgICAgIHRoaXMuY2FudmFzID0gZWwucXVlcnlTZWxlY3RvcignLmNhbnZhcycpO1xuICAgICAgICB0aGlzLmNhbnZhcy5pZCA9IGBjYW52YXMke0ltYWdlVmlld2VyLm5leHRJZCgpfWA7XG4gICAgfVxuXG4gICAgc3RhdGljIG5leHRJZCAoKSB7XG4gICAgICAgIEltYWdlVmlld2VyLl9uZXh0SWQgPSAoSW1hZ2VWaWV3ZXIuX25leHRJZCB8fCAwKSArIDE7XG4gICAgICAgIHJldHVybiBJbWFnZVZpZXdlci5fbmV4dElkO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7Y3YuTWF0fSBtYXQgXG4gICAgICovXG4gICAgc2hvdyAobWF0KSB7XG4gICAgICAgIGN2Lmltc2hvdyh0aGlzLmNhbnZhcy5pZCwgbWF0KTtcbiAgICB9XG59XG5cbmNsYXNzIEltYWdlU291cmNlIHtcbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fSBlbCBcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvciAoZWwpIHtcbiAgICAgICAgdGhpcy5lbCA9IGVsO1xuICAgICAgICB0aGlzLnRodW1ibmFpbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2ltZycpO1xuICAgICAgICB0aGlzLmltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICAgIHRoaXMuaW5wdXRFbCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG5cbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGUgPT4ge1xuICAgICAgICAgICAgdGhpcy50aHVtYm5haWwuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChlLnRhcmdldC5maWxlc1swXSk7XG4gICAgICAgICAgICB0aGlzLmltYWdlLnNyYyA9IHRoaXMudGh1bWJuYWlsLnNyYztcbiAgICAgICAgfSwgZmFsc2UpO1xuICAgIH1cblxuICAgIFxuXG4gICAgLyoqXG4gICAgICogQHJldHVybiB7Y3YuTWF0fVxuICAgICAqL1xuICAgIHJlYWQgKCkge1xuICAgICAgICByZXR1cm4gY3YuaW1yZWFkKHRoaXMuaW1hZ2UpO1xuICAgIH1cbn0iXSwic291cmNlUm9vdCI6IiJ9